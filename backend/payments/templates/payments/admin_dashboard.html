{% extends "admin/core/base.html" %}
{% load static %}

{% block title %}Payments Admin{% endblock %}

{% block content %}
<h1 style="margin-bottom:16px;">💳 Payments</h1>

<!-- Start payment -->
<form method="post" action="" style="margin-bottom:24px; padding:16px; border:1px solid #ddd; border-radius:8px;">
  {% csrf_token %}
  <label for="amount"><b>Amount (PKR)</b></label>
  <input id="amount" name="amount" type="number" step="0.1" min="1" value="10.0"
         style="margin-left:10px; padding:6px 10px; width:140px;">
  <button type="submit" class="button-link" style="margin-left:10px;">▶️ Start Payment</button>
  <p style="margin:8px 0 0; color:#666;">This will create a Payment and redirect you to Easypay.</p>
</form>

<!-- Recent payments -->
<div style="padding:16px; border:1px solid #ddd; border-radius:8px;">
  <h2 style="margin-top:0;">🧾 Recent Payments</h2>
  {% if recent %}
    <table style="width:100%; border-collapse:collapse;">
      <thead>
        <tr>
          <th style="text-align:left; padding:8px; border-bottom:1px solid #eee;">ID</th>
          <th style="text-align:left; padding:8px; border-bottom:1px solid #eee;">User</th>
          <th style="text-align:left; padding:8px; border-bottom:1px solid #eee;">Amount</th>
          <th style="text-align:left; padding:8px; border-bottom:1px solid #eee;">Status</th>
          <th style="text-align:left; padding:8px; border-bottom:1px solid #eee;">OrderRef</th>
          <th style="text-align:left; padding:8px; border-bottom:1px solid #eee;">Initiated</th>
        </tr>
      </thead>
      <tbody>
        {% for p in recent %}
        <tr>
          <td style="padding:8px; border-bottom:1px solid #f5f5f5;">{{ p.id }}</td>
          <td style="padding:8px; border-bottom:1px solid #f5f5f5;">{{ p.user }}</td>
          <td style="padding:8px; border-bottom:1px solid #f5f5f5;">{{ p.amount }}</td>
          <td style="padding:8px; border-bottom:1px solid #f5f5f5;">{{ p.status }}</td>
          <td style="padding:8px; border-bottom:1px solid #f5f5f5;">{{ p.merchant_order_id|default:"—" }}</td>
          <td style="padding:8px; border-bottom:1px solid #f5f5f5;">{{ p.initiated_at }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>No payments yet.</p>
  {% endif %}
</div>

<style>
  .button-link {
    display:inline-block; padding:8px 14px; background:#e2e6ec;
    color:#291f1f; text-decoration:none; border-radius:6px; font-weight:600;
  }
  .button-link:hover { background:#afc5ea; }
  #content-main + div, #nav-sidebar { display:none !important; }
</style>
{% endblock %}