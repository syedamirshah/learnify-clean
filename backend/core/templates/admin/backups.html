{% extends "admin/core/base.html" %}
{% block content %}

<div class="p-6 max-w-4xl mx-auto bg-white rounded-xl shadow-md font-[calibri]">

  <!-- Heading -->
  <h2 class="text-2xl font-semibold text-gray-800 mb-2">ğŸ“¦ Available Backups</h2>
  <p class="text-sm text-gray-600 mb-6">
    Clicking â€œCreate & Download Backupâ€ will generate a fresh JSON dump and download it directly to your computer.
    Existing files listed below are older server-side backups (from before this change).
  </p>

  <!-- Create Backup Form (POST => immediate download via FileResponse) -->
  <div class="mb-8">
    <form method="post" class="inline-block">
      {% csrf_token %}
      <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition">
        ğŸ“¦ Create & Download Backup
      </button>
    </form>
  </div>

  <!-- Backup File List (legacy files that still live on the server) -->
  <div>
    {% if backup_files %}
      <ul class="space-y-4">
        {% for file in backup_files %}
          <li class="border border-gray-200 p-4 rounded-md flex justify-between items-center">
            <span class="text-sm font-mono text-gray-700">{{ file }}</span>
            <div class="space-x-2">
              <a href="{% url 'download_backup' file %}" class="text-blue-600 hover:underline text-sm">â¬‡ Download</a>

              <form action="{% url 'restore_backup' file %}" method="post" class="inline">
                {% csrf_token %}
                <button type="submit"
                        onclick="return confirm('Are you sure you want to restore this backup? This will overwrite current data.')"
                        class="text-green-600 hover:underline text-sm">
                  â™» Restore
                </button>
              </form>
            </div>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="text-gray-500 text-sm italic">No backup files found on server.</p>
    {% endif %}
  </div>

</div>

{% endblock %}